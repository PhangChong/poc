from poc import ceshi

# 漏洞名称到漏洞扫描函数的映射字典
vulnerability_scan_functions = {
    "测试漏洞（robots.txt）": ceshi.scan_ceshi,
}


def ceshi_detection(vulnerability, url, proxies, append_to_output, serverJ_key):
    if vulnerability in vulnerability_scan_functions:
        # 获取对应漏洞扫描函数并调用
        scan_function = vulnerability_scan_functions[vulnerability]
        scan_function(url, proxies, append_to_output, serverJ_key=serverJ_key, bugName=vulnerability)
    else:
        append_to_output(f"未找到漏洞扫描函数: {vulnerability}", "white")
