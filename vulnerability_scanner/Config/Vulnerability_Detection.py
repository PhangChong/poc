from poc import Fanwei_e_Weaver_sql_injection_scan, yikatong_ailianyun_scan, Telesquare_TLR_2005Ksh_scan, \
    SFDI_Security_Management_System_test_qrcode_b_Command_Vuln_Scan, HWL_2511_SSpopencgi_Command_scan, \
    Likeshop_File_upload_vuln_scan, Toseiweb_network_test_Command_scan, NUUO_camera_command_scan, \
    Telesquare_TLR_2005Ksh_RCE_scan, Junos_webauth_operation_upload_scan, Hikvision_Operation_Management_Center_scan, \
    Altenergy_Power_System_Control_scan, Multiple_gateway_security_devices_scan, Uniview_video_surveillance_scan, \
    NSFOCUS_bastionhost_privileges_scan, Dahua_DSS_system_itcBulletin_SQL_injection_scan, \
    ANHENG_Mingyu_security_gateway_file_upload_scan, Ivanti_VPN_RCE_scan, Yongyou_getApp_SQL_scan, \
    Dahua_QVD_2023_45063_scan, Byzoro_Smart_Management_upload_scan, XMall_Open_Marketplace_SQL_Injection_scan, \
    CERIO_DT_Series_Router_Command_Vul_scan, Youdian_CMS_GetSpecial_SQL_vul_scan, WordPres_Bricks_Builder_scan, \
    Tongtianxing_CMSV6_vehicle_video_scan, Glodon_Linkworks_GetAllData_information_scan, Lanling_EIS_SQL_vul_scan, \
    CVE_2024_2330_scan, CVE_2024_27198_scan, JS_ligerComboBox_information_scan, ceshi, \
    Lianda_OA_FileManage_UpLoadFile_scan, YouyongTPlus_InitServerInfo_SQL_injection_scan, \
    FE_upload_Attachment_Servlet_scan, Tongda_OA_XSS_scan, JinsanZhongduan_v9_SQL_injection_scan, \
    Zhiyuan_OA_ucpclogin_pwd_reset_scan, XVE_2023_23744_scan, Bang_CRM_JILIYU_sql_scan, SpringBlade_errorlist_SQL_scan, \
    JeePlus_validateMobile_SQL_scan, ChatGPT_Next_Web_XSS_CVE_2023_49785_scan

# 漏洞名称到漏洞扫描函数的映射字典
vulnerability_scan_functions = {
    "144.ChatGPT-Next-Web XSS漏洞(CVE-2023-49785)": ChatGPT_Next_Web_XSS_CVE_2023_49785_scan.scan_ChatGPT_Next_Web_XSS_CVE_2023_49785,
    "143.JeePlus快速开发平台 validateMobile SQL注入": JeePlus_validateMobile_SQL_scan.scan_JeePlus_validateMobile_SQL,
    "142.SpringBlade errorlist SQL报错注入": SpringBlade_errorlist_SQL_scan.scan_SpringBlade_errorlist_SQL,
    "141.帮管客 CRM jiliyu SQL注入漏洞": Bang_CRM_JILIYU_sql_scan.scan_Bang_CRM_JILIYU_sql,
    "140.通天星CMSV6车载定位监控平台 SQL注入漏洞(XVE-2023-23744)": XVE_2023_23744_scan.scan_XVE_2023_23744,
    "致远OA ucpcLogin存在密码重置漏洞": Zhiyuan_OA_ucpclogin_pwd_reset_scan.scan_Zhiyuan_OA_ucpclogin_pwd_reset,
    "金山终端安全系统V9.0 SQL注入漏洞": JinsanZhongduan_v9_SQL_injection_scan.scan_JinsanZhongduan_v9_SQL_injection,
    "通达OA存在反射XSS漏洞": Tongda_OA_XSS_scan.scan_Tongda_OA_XSS,
    "飞企互联FE业务协作平台uploadAttachmentServlet任意文件上传漏洞": FE_upload_Attachment_Servlet_scan.scan_FE_upload_Attachment_Servlet,
    "用友畅捷通TPlus InitServerInfo存在SQL注入漏洞": YouyongTPlus_InitServerInfo_SQL_injection_scan.scan_YouyongTPlus_InitServerInfo_SQL_injection,
    "联达OA FileManage-UpLoadFile存在任意文件上传漏洞": Lianda_OA_FileManage_UpLoadFile_scan.scan_Lianda_OA_FileManage_UpLoadFile,
    "测试漏洞（robots.txt）": ceshi.scan_ceshi,
    "140.京师心智心理健康测评系统-账号密码泄露漏洞": JS_ligerComboBox_information_scan.scan_JS_ligerComboBox_information,
    "139.JetBrains TeamCity 身份验证绕过漏洞(CVE-2024-27198)": CVE_2024_27198_scan.scan_CVE_2024_27198,
    "138.网康科技 NS-ASG 应用安全网关 SQL注入漏洞(CVE-2024-2330)": CVE_2024_2330_scan.scan_CVE_2024_2330,
    "137.蓝凌EIS智慧协同平台 rpt_listreport_defi露漏洞nefield.aspx SQL注入漏洞": Lanling_EIS_SQL_vul_scan.scan_Lanling_EIS_SQL_vul,
    "136.广联达Linkworks GetAllData 信息泄露漏洞": Glodon_Linkworks_GetAllData_information_scan.scan_Glodon_Linkworks_GetAllData_information,
    "135.通天星CMSV6 车载视频监控平台 信息泄露漏洞": Tongtianxing_CMSV6_vehicle_video_scan.scan_Tongtianxing_CMSV6_vehicle_video,
    "134.WordPres Bricks Builder 前台RCE漏洞(CVE-2024-25600)": WordPres_Bricks_Builder_scan.scan_WordPres_Bricks_Builder,
    "133.友点CMS GetSpecial SQL注入漏洞": Youdian_CMS_GetSpecial_SQL_vul_scan.scan_Youdian_CMS_GetSpecial_SQL_vul,
    "132.CERIO DT系列路由器命令执行漏洞": CERIO_DT_Series_Router_Command_Vul_scan.scan_CERIO_DT_Series_Router_Command_Vul,
    "131.XMall开源商城SQL注入漏洞(CVE-2024-24112)": XMall_Open_Marketplace_SQL_Injection_scan.scan_XMall_Open_Marketplace_SQL_Injection,
    "130.百卓Smart管理平台uploadfile.php文件上传漏洞(CVE-2024-0939)": Byzoro_Smart_Management_upload_scan.scan_Byzoro_Smart_Management_upload,
    "129.大华智能物联综合管理平台 任意文件读取漏洞": Dahua_QVD_2023_45063_scan.scan_Dahua_QVD_2023_45063,
    "128.用友移动管理系统 getApp SQL注入漏洞": Yongyou_getApp_SQL_scan.scan_Yongyou_getApp_SQL,
    "127.Ivanti VPN RCE漏洞复现（CVE-2024-21887）": Ivanti_VPN_RCE_scan.scan_Ivanti_VPN_RCE,
    "125.安恒明御安全网关 aaa_local_web_preview文件上传漏洞": ANHENG_Mingyu_security_gateway_file_upload_scan.scan_ANHENG_Mingyu_security_gateway_file_upload,
    "124.大华 DSS 数字监控系统 itcBulletin SQL 注入漏洞": Dahua_DSS_system_itcBulletin_SQL_injection_scan.scan_Dahua_DSS_system_itcBulletin_SQL_injection,
    "123.绿盟 SAS堡垒机 local_user.php 权限绕过漏洞": NSFOCUS_bastionhost_privileges_scan.scan_NSFOCUS_bastionhost_privileges,
    "122.宇视科技视频监控 main-cgi 文件信息泄露漏洞": Uniview_video_surveillance_scan.scan_Uniview_video_surveillance,
    "121.多家网关-安全设备存在远程命令执行漏洞": Multiple_gateway_security_devices_scan.scan_Multiple_gateway_security_devices,
    "120.Altenergy电力系统控制软件 RCE漏洞": Altenergy_Power_System_Control_scan.scan_Altenergy_Power_System_Control,
    "119.海康运行管理中心 RCE漏洞": Hikvision_Operation_Management_Center_scan.scan_Hikvision_Operation_Management_Center,
    "117.Junos webauth_operation.php 文件上传漏洞(CVE-2023-36844)": Junos_webauth_operation_upload_scan.scan_Junos_webauth_operation_upload,
    "116.Telesquare TLR-2005Ksh 路由器 RCE漏洞": Telesquare_TLR_2005Ksh_RCE_scan.scan_Telesquare_TLR_2005Ksh_RCE,
    "115.NUUO摄像头远程命令执行漏洞": NUUO_camera_command_scan.scan_NUUO_camera_command,
    "114.Toseiweb管理端network_test.php参数远程命令执行漏洞": Toseiweb_network_test_Command_scan.scan_Toseiweb_network_test_Command,
    "113.likeshop单商户商城系统任意文件上传漏洞": Likeshop_File_upload_vuln_scan.scan_Likeshop_File_upload_vuln,
    "112.HWL-2511-SSpopen.cgi命令执行漏洞": HWL_2511_SSpopencgi_Command_scan.scan_HWL_2511_SSpopencgi_Command,
    "111.思福迪 运维安全管理系统 test_qrcode_b 远程命令执行漏洞": SFDI_Security_Management_System_test_qrcode_b_Command_Vuln_Scan.Scan_SFDI_Security_Management_System_test_qrcode_b_Command_Vuln,
    "110.Telesquare TLR-2005Ksh 路由器 getUsernamePassword 信息泄露": Telesquare_TLR_2005Ksh_scan.scan_Telesquare_TLR_2005Ksh,
    "109.优卡特脸爱云一脸通智慧管理平台权限绕过漏洞(CVE-2023-6099)": yikatong_ailianyun_scan.scan_yikatong_ailianyun,
    "106.泛微e-Weaver SQL注入": Fanwei_e_Weaver_sql_injection_scan.scan_Fanwei_e_Weaver_sql_injection
}


def detection(vulnerability, url, proxies, append_to_output, serverJ_key):
    if vulnerability in vulnerability_scan_functions:
        # 获取对应漏洞扫描函数并调用
        scan_function = vulnerability_scan_functions[vulnerability]
        scan_function(url, proxies, append_to_output, serverJ_key=serverJ_key, bugName=vulnerability)
    else:
        append_to_output(f"未找到漏洞扫描函数: {vulnerability}", "red")
