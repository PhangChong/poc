import os
import urllib.parse
import urllib.request


def sc_send(text, desp='', ServerJ_Key=" "):
    ServerJ_Key = ServerJ_Key.strip()  # 清除空格
    if ServerJ_Key.lower() not in ("off", ""):
        print("server启动成功，key：", ServerJ_Key, "------")
        postdata = urllib.parse.urlencode({'text': text, 'desp': desp}).encode('utf-8')
        urlserver = f'https://sctapi.ftqq.com/{ServerJ_Key}.send'
        req = urllib.request.Request(urlserver, data=postdata, method='POST')
        with urllib.request.urlopen(req) as response:
            result = response.read().decode('utf-8')
        return result
    else:
        return "Server酱off状态"


if __name__ == '__main__':
    url = "http://test"
    sc = sc_send('主人发现病毒了', f"漏洞连接: {url}\r ", ServerJ_Key="    OFF   ")
    print("serverj.py----\n", sc)
